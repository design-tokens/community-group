---
import Stack from '@/components/Stack/Stack.astro';
import Text from '@/components/Text/Text.astro';
import { SITE_TITLE } from '@/consts';
import { menu } from '@/site.config';
import SocialIcon from '@/components/SocialIcon.astro';
import External from '@/components/External.astro';

const year = new Date().getFullYear();
const url = new URL(Astro.request.url);
const isAbsolute = (path: string) => path.startsWith('https://');
---

<footer class="footer" aria-label="Main">
  <div class="inner">
    <Stack axis="y" gap={4}>
      <Text variant="sm">
        <span>Â© {year}</span>
        <span>{SITE_TITLE}</span>
      </Text>
      <Text variant="xs" color="color-text-subdued">Deploys by Netlify</Text>
    </Stack>

    <div role="group">
      <h5>Pages</h5>
      <nav aria-label="Pages">
        <ul class="ul">
          {
            menu.pages.map((link) => (
              <li class="li">
                <a
                  aria-current={url.pathname === link.path ? 'page' : false}
                  data-astro-prefetch
                  class="link"
                  href={link.path}
                  aria-label={link.title}
                  target={isAbsolute(link.path) ? '_blank' : undefined}
                >
                  <Fragment set:html={link.title} />
                  {isAbsolute(link.path) ? <External /> : null}
                </a>
              </li>
            ))
          }
        </ul>
      </nav>
    </div>

    <div role="group">
      <h5>Social</h5>
      <nav class="social" aria-label="Social">
        <ul class="ul">
          {
            menu.social.map((link) => (
              <li class="li">
                <a
                  class="social-link"
                  href={link.path}
                  target={isAbsolute(link.path) ? '_blank' : undefined}
                  title={link.title}
                >
                  <SocialIcon url={link.path} aria-hidden />
                </a>
              </li>
            ))
          }
        </ul>
      </nav>
    </div>
  </div>

  <style lang="scss">
    .footer {
      background: var(--color-bg);
      border-block-end-width: 0;
      border-block-start-color: var(--color-border);
      border-block-start-width: 1px;
      border-inline-width: 0;
      border-style: solid;
      margin-block-start: var(--base-space-8);
      padding-block-end: var(--base-space-12);
      padding-block-start: var(--base-space-8);
      padding-inline: var(--page-padding-x);
      position: relative;
      z-index: 10;

      h5 {
        color: var(--color-text-subdued);
        font-weight: 400;
        margin: 0 0 var(--base-space-4);
      }
    }

    .inner {
      display: grid;
      gap: var(--base-space-8);

      @media (width >= 750px) {
        grid-template-columns: 2fr 1fr 1fr;
      }
    }

    .ul,
    .li {
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .link {
      font-size: var(--font-size-sm);
      line-height: 2;
      text-decoration: none;
      &:hover {
        text-decoration: underline;
      }
    }

    .social {
      .ul {
        display: flex;
      }
    }

    .social-link {
      align-items: center;
      display: flex;
      justify-content: center;
      width: 1.5rem;
      height: 1.5rem;

      &:hover {
        color: var(--color-action-subdued);
      }
    }
  </style>
</footer>
