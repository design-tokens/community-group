{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://www.designtokens.org/schemas/2025.10/resolver/modifier.json",
  "title": "Modifier",
  "description": "A modifier is similar to a set, but allows for conditional inclusion via the contexts map. A modifier MUST declare a contexts map of string values to arrays of token sources.",
  "type": "object",
  "required": ["contexts"],
  "additionalProperties": false,
  "properties": {
    "description": {
      "title": "Description",
      "type": "string",
      "description": "A human-readable description of the purpose of the modifier."
    },
    "contexts": {
      "title": "Contexts",
      "type": "object",
      "description": "A map of context names to arrays of token sources. Each context represents a possible variant (e.g., 'light' vs 'dark' for theme, 'small' vs 'large' for size).",
      "minProperties": 2,
      "patternProperties": {
        "^.+$": {
          "$ref": "#/definitions/tokenSourcesForModifiers",
          "description": "An array of token sources for this context. Can contain reference objects pointing to JSON files, inline token definitions, or any combination. If the array declares multiple sources, they will be merged in array order, meaning if a token is declared multiple times, the last occurrence in the array will be the final value."
        }
      },
      "additionalProperties": false
    },
    "default": {
      "title": "Default Context",
      "type": "string",
      "description": "An optional default value that MUST match one of the keys in contexts. If provided, tools will use this context when no input is provided for this modifier.",
      "$comment": "JSON Schema cannot validate that this value matches a key in 'contexts'. This validation must be performed at runtime by the implementation."
    },
    "$extensions": {
      "title": "Extensions",
      "type": "object",
      "description": "Vendor-specific extensions. Keys are vendor-specific namespaces."
    }
  },
  "definitions": {
    "referenceObjectForModifiers": {
      "title": "Reference Object (For Modifiers)",
      "type": "object",
      "required": ["$ref"],
      "properties": {
        "$ref": {
          "title": "JSON Reference",
          "type": "string",
          "format": "uri-reference",
          "description": "A JSON Pointer (RFC 6901) or URI reference. Modifiers MUST NOT reference other modifiers (#/modifiers/...) or resolutionOrder items (#/resolutionOrder/...).",
          "not": {
            "anyOf": [
              {
                "pattern": "^#/modifiers/",
                "$comment": "Modifiers cannot reference other modifiers"
              },
              {
                "pattern": "^#/resolutionOrder/",
                "$comment": "Nothing can reference resolutionOrder items"
              }
            ]
          }
        }
      },
      "description": "A reference object for use within modifier contexts. Cannot point to other modifiers or resolutionOrder items."
    },
    "tokenSourcesForModifiers": {
      "title": "Token Sources (For Modifiers)",
      "type": "array",
      "description": "An array of token sources for modifier contexts - can reference sets but not other modifiers or resolutionOrder items.",
      "items": {
        "oneOf": [
          {
            "$ref": "#/definitions/referenceObjectForModifiers"
          },
          {
            "$ref": "../format.json",
            "description": "Inline design tokens in DTCG format"
          }
        ]
      }
    }
  }
}
